## Git Rule 4: Формирование коммитов рефакторинга



К рефакторингу относятся изменения, которые не влияют на логический результат работы кода,
а влияют только на его качество.

Простота, которую предоставляет IDE для рефакторинга, меняет восприятие разработчика на сложность внесенных в код 
изменений. Это приводит к сложности чтения и проведения ревью коммитов, связанных с рефакторингом.
Чтобы решить проблему, предлагается следовать следующим правилам для формирования коммитов во время рефакторинга:

- Во время разбиения на коммиты заботиться о человеке, который будет выполнять ревью этих изменений.
  То есть проводить ревью изменений по каждому рефакторингу должно быть так же легко, как и
  выполнять их.

- Не смешивать в коммитах изменения кода, которые влияют на логический результат работы кода,
  и рефакторинг.

- Писать в сообщении коммита всё, что было изменено в рамках коммита. Если появляется желание оформить описание в виде списка изменений, то стоит задуматься над разбиением на отдельные коммиты.

  - "Правки после ревью" - это пример плохого сообщения коммита. Оно не отражают суть изменений и позволяет
    смешивать в одном коммите слишком много разнообразных изменений.

- Если рефакторинг сложный, и его идея теряется при разбиении на мелкие коммиты, то стоит в каждом коммите добавлять информацию о контексте.

  - Примеры текстов коммитов рефакторинга по вынесению методов одного сервиса в другой:

    - ```
      HRL-1 Переименование метода SomeService#someMethod1() 
      
      Переименование метода SomeService#someMethod1() в SomeService#anotherMethod1().
      
      Контекст рефакторинга: перенос части методов из SomeService в
      AnotherService.
      ```

    - ```
      HRL-1 Переименование метода SomeService#someMethod2() 
      
      Переименование метода SomeService#someMethod2() в SomeService#anotherMethod2().
      
      Контекст рефакторинга: перенос части методов из SomeService в
      AnotherService.
      ```

    - ```
      HRL-1 Перемещение метода SomeService#anotherMethod1() 
      
      Перемещение метода SomeService#anotherMethod1() в AnotherService. 
      
      Контекст рефакторинга: перенос части методов из SomeService в
      AnotherService.
      ```

    - ```
      HRL-1 Перемещение метода SomeService#anotherMethod2() 
      
      Перемещение метода SomeService#anotherMethod2() в AnotherService. 
      
      Контекст рефакторинга: перенос части методов из SomeService в
      AnotherService.
      ```

- Любой рефакторинг, подразумевающий изменения сразу в нескольких участках/файлах кода, должен быть в отдельном коммите.
  Примеры изменений, которые точно должны быть в отдельных коммитах:
  
  - Перемещение файла или группы файлов из одной общей папки в другую общую папку средствами IDE.
  - Переименование метода, который используется в разных местах, средствами IDE.
  - Удаление сущностей средствами IDE.
  - Замена одной повторяющейся фразы в комментариях кода на другую с помощью "replace all" или поиском по проекту.
  
- Не уходить в крайность и не разбивать коммиты слишком сильно. Примеры:
  - Перемещение множества файлов из одной общей для всех этих файлов папки в другую общую для всех этих файлов папки не стоит разбивать на несколько разных коммитов по каждому файлу.
  - Разнообразные правки *оформления* комментариев можно оставлять в одном коммите. Но, опять же, если правки уже не только по оформлению и массовые, то стоит разбить.
